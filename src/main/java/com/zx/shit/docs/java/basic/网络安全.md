
## 网络安全总结


###1.HTTP/1.x
• 缺陷：线程阻塞，同一时间内，同一域名请求有一定数量限制，超过限制数目的请求会被阻塞。

###1.1 Http1.0
• 缺陷：浏览器与服务器只保持短暂的连接，浏览器的每次请求都需要与服务器建立一个TCP连接（TCP连接的新建成本很高，因为需要客户端和服务器三次握手），
服务器完成请求处理后立即断开TCP连接，服务器不跟踪每个客户也不记录过去的请求；
• 解决方案：
    ▪ 添加头信息----非标准的Connection字段Connection：keep-alive
    
###1.1：
• 改进点：
    1.持久连接，即TCP连接默认不关闭，可以被多个请求复用，不用声明Connection：keep-alive(对于同一个域名，大多数浏览器允许同时建立6个持久连接)
    2.管道机制，即在同一个TCP连接里面，客户端可以同时发送多个请求。
    3.分块传输编码，即服务端没产生一块数据，就发送了一块，采用"流模式"而取代"缓存模式"。
    4.新增请求方式，PUT:请求服务器存储一个资源；DELETE:请求服务器删除标识的资源；OPTIONS:请求查询服务器的性能，或者查询与资源相关的选项和需求；
      TRACE:请求服务器回送收到的请求信息，用于测试或诊断；
      CONNECT:保留将来使用
• 缺点：
    1.虽然允许复用TCP连接，但是同一个TCP连接里面，所有的数据通信是按次序进行的。服务器只有处理完一个请求，才会接着处理下一个请求。
        如果前面处理的慢，后面请求会排队，这就是"对头阻塞"
    2.避免方式：一是减少请求数，二是同时多开持久连接。

###1.3.HTTP2.0
• 特点：
    1.采用二进制格式而非文本格式；
    2.完全多路复用，而非有序阻塞的、只需一个连接即可实现并行；
    3.使用报头压缩，降低开销。
    4.服务器推送。
    
###2.HTTPS
•HTTP协议通常承载在TCP协议之上，Https是在Http和TCP之间加了一层协议（SSL/TSL），这就是我们常说的HTTPS.

###2.1HTTPS的主要作用。
1.对数据进行加密，建立一个信息安全通道，来保证传输过程中的数据安全。
2.对网址服务器进行真实身份认证。

###2.2HTTPS和HTTP的区别
1. HTTPS是加密传输协议，HTTP是铭文传输协议；
2. HTTPS需要使用到SSL证书，而HTTP不用；
3. HTTPS比HTTP更加安全，对搜索引擎更友好，利于SEO；
4. HTTPS标准端口443，HTTP标准端口80；
5. HTTPS基于传输层，HTTP基于应用层；

###2.3HTTPS和HTTP的工作过程区别
• HTTP包含动作：
    1.浏览器打开了一个TCP连接
    2.浏览器发送HTTP请求到服务端。
    3.服务器发送HTTP回应信息到浏览器
    4.TCP连接关闭
• SSL包含动作：
    1.验证服务器端
    2.客户端和服务器端选择加密算法和密码，确保双方都支持
    3.验证客户端（可选）
    4.使用公钥加密技术来生成共享加密数据
    5.创建一个加密的SSL连接
    6.基于该SSL连接传递HTTP请求

###2.4HTTPS加密方式
• 对称加密：加密解密都使用同一个秘钥；
• 非对称加密：
    ▪ 加密解密使用不同秘钥，分为公钥，私钥。
    ▪ 公钥和算法都是公开的，私钥是保密的。
• 非对称加密过程：
    1.服务端生成配对的公钥和私钥。
    2.私钥保存在服务端，公钥发送给客户端。
    3.客户端使用公钥加密铭文传给服务端。
    4.服务端使用私钥解密密文得到铭文。
• 数字前面：签名就是在信息的后面再加上一段内容，可以证明信息没有被修改过。

###3.HTTP请求过程
• HTTP请求过程：
    ▪ 浏览器根据域名解析IP地址,也叫DNS查找过程：
        ★ 浏览器缓存：首先所属浏览器自身的DNS缓存（大概1分钟存1000条缓存），在当中查找，有则结束，无则进行下一步查找。
        ★ 系统缓存：浏览器缓存中未找到IP，从系统缓存查找，有则结束，无则下一步。
        ★ 路由器缓存：系统缓存未找到，从路由器缓存查找，有则结束，无则下一步。
        ★ ISP（互联网服务提供商）DNS缓存：路由器缓存未找到，从ISP缓存DNS服务器中查找。
        总结DNS寻址过程，浏览器缓存-->系统缓存-->路由器缓存-->ISP缓存-->DNS服务器。
    ▪ 浏览器与Web服务器建立连接：
        ★ TCP三次握手，client send SYN server, server send SYN+ACK, client send ACK  server.
    ▪ 浏览器给Web服务器发送一个HTTP请求。
        ★ HTTP请求由，请求行(request line)，请求头(headers)，空行(blank line)和请求数据(request body)4部分组成。
    ▪ 服务端响应HTTP请求，浏览器得到HTML代码
        ★ HTTP响应报文由状态行（status line）、响应头部（headers）、空行（blank line）和响应数据（response body）4个部分组成。
    ▪ 浏览器解析HTML代码，并请求HTML代码中的资源
        ★ 浏览器拿到HTML文件，并解析，如有静态资源时，请求服务器下载。
    ▪ 关闭TCP连接，浏览器对页面进行渲染展示给用户
        ★ 浏览器进行页面渲染展示后，根据Connection来判断是否需要关闭TCP连接。     

###4.HTTPS请求过程
由于HTTP是铭文传输协议，数据没有进行加密，浏览器和服务器传输数据时，容易被黑客截取数据，并进行篡改，造成用户信息泄漏，数据安全。
• HTTPS请求过程：
    ▪ 客户端向服务端发送HTTPS请求，连接服务器的443接口；
    ▪ 服务端将非对称加密公钥传给客户端，以证书的形式传递给客户端。
    ▪ 客户端接收该公钥进行验证，有问题HTTPS请求无法继续，没有问题，客户端随机生成私钥client key，对数据进行加密，再使用公钥对client key进行非对称加密。
      客户端发送二次HTTP请求，将加密后的客户端key传给服务端。
    ▪ 服务端使用私钥进行解密，得到client key，再使用 client key 对数据进行加密。
    ▪ 将对称加密的数据传给客户端，客户端使用对称解密，得到服务端的数据。
    
### 5.HTTPS 加密算法
• 对称加密：有流式、分组两种，加密和解密都是使用的同一个密钥。
   ▪ 例如：DES、AES-GCM、ChaCha20-Poly1305 等。
• 非对称加密：加密使用的密钥和解密使用的密钥是不相同的，分别称为：公钥、私钥，公钥和算法都是公开的，私钥是保密的。
            非对称加密算法性能较低，但是安全性超强，由于其加密特性，非对称加密算法能加密的数据长度也是有限的。
   ▪ 例如：RSA、DSA、ECDSA、 DH、ECDHE 等。
• 哈希算法：将任意长度的信息转换为较短的固定长度的值，通常其长度要比信息小得多，且算法不可逆。
   ▪ 例如：MD5、SHA-1、SHA-2、SHA-256 等。
• 数字签名：签名就是在信息的后面再加上一段内容（信息经过 hash 后的值），可以证明信息没有被修改过。
          hash 值一般都会加密后（也就是签名）再和信息一起发送，以保证这个 hash 值不被修改。

